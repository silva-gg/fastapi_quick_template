# Alembic Migrations

This directory contains database migration files generated by Alembic.

## What are migrations?

Migrations are version control for your database schema. They allow you to:
- Track changes to your database structure over time
- Apply changes consistently across different environments
- Roll back changes if needed
- Collaborate with team members on database changes

## Directory Structure

- `env.py` - Configuration for Alembic environment
- `script.py.mako` - Template for generating new migration files
- `versions/` - Contains all migration files

## Common Commands

### Create a new migration (auto-detect changes)
```bash
alembic revision --autogenerate -m "Description of changes"
```

### Apply migrations (upgrade to latest)
```bash
alembic upgrade head
```

### Rollback one migration
```bash
alembic downgrade -1
```

### View migration history
```bash
alembic history
```

### Check current database version
```bash
alembic current
```

## Important Notes

1. **Always review auto-generated migrations** before applying them
2. **Test migrations** in a development environment first
3. **Never modify applied migrations** - create new ones instead
4. **Import all models** in `env.py` for detection
5. **Commit migrations** to version control with your code

## Workflow

1. Make changes to your models in `models.py`
2. Run: `alembic revision --autogenerate -m "Add user table"`
3. Review the generated migration file in `versions/`
4. Apply the migration: `alembic upgrade head`
5. Commit both the model changes and migration file

## Example Migration File

Migration files are stored in `versions/` and follow this pattern:
- Filename: `<revision>_<description>.py`
- Contains `upgrade()` and `downgrade()` functions
- Tracked by revision ID

## Troubleshooting

### Alembic can't detect my model
- Ensure you imported the model in `alembic/env.py`
- Check that the model inherits from `BaseModel`

### Migration conflicts
- Use `alembic merge heads` to resolve multiple heads
- Or use `alembic upgrade head` to apply all pending migrations

### Need to make manual changes
- Use `alembic revision -m "Manual changes"` for custom migrations
- Edit the generated file with your SQL operations
